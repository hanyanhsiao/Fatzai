<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Shopping Car</title>
    <link rel="stylesheet" href="./css/common/all.css" />
    <link rel="stylesheet" href="./css/common/common.css">
    <link rel="stylesheet" href="./css/car.css" />
    <link rel="stylesheet" href="./css/rwd.css">
    <!--引入font-awesome icon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
        integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>
    <header class="header"></header>

    <main>
        <div class="process">
            <div class="step">
                <span class="badge badge1">
                    <!-- before -->
                    <span class="text">1</span>
                    <!-- after -->
                </span>
                <span>購物車</span>
            </div>
            <div class="step">
                <span class="badge badge2">
                    <!-- before -->
                    <span class="text">2</span>
                    <!-- after -->
                </span>
                <span>填寫資料</span>
            </div>
            <div class="step">
                <span class="badge badge3">
                    <!-- before -->
                    <span class="text">3</span>
                    <!-- after -->
                </span>
                <span>確認訂單</span>
            </div>
            <div class="step">
                <span class="badge badge4">
                    <!-- before -->
                    <span class="text">4</span>
                    <!-- after -->
                </span>
                <span>確認付款</span>
            </div>


        </div>
        <!-- --------購物車----------->
        <div class="car">
            <p>購物車</p>

            <!-- ---標題-- -->
            <ul class="car_title">
                <li>商品</li>
                <li>名稱</li>
                <li>規格</li>
                <li>金額</li>
                <li>數量</li>
                <li>合計</li>
                <li>刪除</li>
            </ul>
            <!-- 購買商品 -->
            <div class="car_item_block">
                <!-- <ul class="car_item">
                    <li> <a href="./item.html"><img src="./image/items/tart (1).jpg" alt=""></a></li>
                    <li>提拉米蘇塔</li>
                    <li>圓塔</li>
                    <li>$199</li>
                    <li>2</li>
                    <li>$398</li>
                    <li><i class="fa-regular fa-circle-xmark"></i></li>
                </ul>
                <ul class="car_item">
                    <li> <a href="./item.html"><img src="./image/items/tart (6).jpg" alt=""></a></li>
                    <li>提拉米蘇塔</li>
                    <li>方塔</li>
                    <li>$199</li>
                    <li>2</li>
                    <li>$398</li>
                    <li><i class="fa-regular fa-circle-xmark"></i></li>
                </ul> -->
            </div>

        </div>
        <!-- 加購區 -->
        <div class="more">
            <p>限量加購</p>
            <ul class="more_items">
                <li>
                    <img src="./image/material/candles.jpg">
                    <h3>數字蠟燭一組</h3>
                    <p>$50</p>
                    <button>
                        <p>加入購物車</p>
                        <script src="https://cdn.lordicon.com/ritcuqlt.js"></script>
                        <lord-icon src="https://cdn.lordicon.com/slkvcfos.json" trigger="loop" delay="1000"
                            colors="primary:#dc9f58,secondary:#dc9f58" style="width:30px;height:30px">
                        </lord-icon>
                    </button>

                </li>
                <li>
                    <img src="./image/items/tart (5).jpg">
                    <h3>Pistache tart </h3>
                    <p>$160</p>
                    <button>
                        <p>加入購物車</p>
                        <script src="https://cdn.lordicon.com/ritcuqlt.js"></script>
                        <lord-icon src="https://cdn.lordicon.com/slkvcfos.json" trigger="loop" delay="1000"
                            colors="primary:#dc9f58,secondary:#dc9f58" style="width:30px;height:30px">
                        </lord-icon>
                    </button>
                </li>
                <li>
                    <img src="./image/items/mousse (5).jpg">
                    <h3>Chocolate Cake </h3>
                    <p>$99</p>
                    <button>
                        <p>加入購物車</p>
                        <script src="https://cdn.lordicon.com/ritcuqlt.js"></script>
                        <lord-icon clas="car_icon" src="https://cdn.lordicon.com/slkvcfos.json" trigger="loop"
                            delay="1000" colors="primary:#dc9f58,secondary:#dc9f58" style="width:30px;height:30px">
                        </lord-icon>
                    </button>
                </li>
                <li>
                </li>
                <li>
                </li>

            </ul>

        </div>

        <!-- --------運送及付款方式/訂單資訊總結----------->
        <div class="order_inf">

            <!------左側運送資訊-------->
            <div class="delivery">
                <p> 運送及付款方式</p>
                <label for=""></label>
                <div class="pickup">
                    <label for="pickup">取貨方式</label>
                    <select name="pickup" id="">
                        <option>門市自取</option>
                        <option>宅配</option>
                    </select>

                </div>

                <div class="pay">
                    <label for="pay">付款方式</label>
                    <select name="pay" id="">
                        <option>信用卡</option>
                        <option>LINE PAY</option>
                        <option>門市現金付款</option>
                    </select>

                </div>

                <!------※注意事項※----->
                <div class="attention">
                    <h3>※注意事項※</h3>
                    <div class="content">
                        <p>※ 冷凍宅配運費一律$170，消費滿$1000免運費。</p>
                        <p>※ 我們宅配與黑貓宅急便配合運送，無法指定到貨日期。</p>
                        <p>※ 店面自取時間: 週一至週五11:30-19:00</p>
                        <p>※ 請確認購買商品與聯絡資訊正確無誤。</p>


                    </div>
                </div>

            </div>



            <!------右側訂單資訊-------->
            <div class="check">
                <p>訂單資訊</p>
                <div class="money">
                    <div>
                        <p>小計:</p>
                        <p>$796</p>
                    </div>
                    <button>使用折扣碼</button>
                    <div>
                        <p>折扣:</p>
                        <p>$50</p>
                    </div>
                    <div>
                        <p>運費:</p>
                        <p>$170</p>
                    </div>

                    <div class="total">
                        <p>合計:</p>
                        <p>$916</p>
                    </div>
                    <div class="buy">
                        <button type="button">確認結帳</button>
                    </div>
                </div>

            </div>

        </div>

    </main>

    <footer class="footer"></footer>

    <!-- -----------script------------- -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdn.lordicon.com/ritcuqlt.js"></script>
    <script src="./js/common.js"></script>
    <script>
        // -----------------------抓出localstorage商品並顯示--------------------------
        function get_items() {
            let items = JSON.parse(localStorage.getItem("car"));
            // console.log(items);

            if (items) {
                let list_html = ""; //

                items.forEach(function (item, i) {
                    // console.log(item);
                    list_html += `<ul class="car_item">
                    <li> <a href="./item.html"><img src="${get_img(item.item_id)}" alt=""></a></li>
                    <li>${item.name}</li>
                    <li class="item_id">${item.item_id}</li>
                    <li>${item.dollars}</li>
                    <li>${item.num}</li>
                    <li>${item.total}</li>
                    <li><i class="fa-regular fa-circle-xmark"></i></li>
                </ul>`;
                })

                $('.car_item_block').html(list_html);
                // let ul_task_list = document.getElementsByClassName("task_list")[0];
                // ul_task_list.innerHTML = list_html;
            }

        };

        // -----------------------刪除商品及localstorage--------------------------
        function delete_items() {
            $('.fa-circle-xmark').click(function () {
                //取出ul
                let target_item_ul = $(this).closest('ul');
                //取出item_id
                let target_item = $(this).closest('ul').children('.item_id').html();

                //1 移除整條商品列，淡出1秒
                $(target_item_ul).addClass('fade_out');
                setTimeout(function () { $(target_item_ul).remove() }, 1000);

                //2 移除localstorage
                let tasks = JSON.parse(localStorage.getItem("car"));
                //不相同的要留下
                let updated_tasks = tasks.filter(function (item, i) {
                    return target_item != item.item_id;
                });
                // 回存至 localStorage
                localStorage.setItem("car", JSON.stringify(updated_tasks));
            })
        }

        $(function () {
            get_items();
            delete_items();
        })

    </script>
</body>

</html>